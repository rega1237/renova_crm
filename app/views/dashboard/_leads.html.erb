<div data-controller="leads-chart" class="bg-white rounded-xl shadow p-6">
  <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 w-full">
      <div>
        <label class="block text-sm font-medium text-negro-onix">Origen (source)</label>
        <select data-leads-chart-target="source" data-action="change->leads-chart#updateFilters" class="mt-1 block p-2 w-full rounded-md border-gray-300 shadow-sm focus:border-rojo-carmesi focus:ring-rojo-carmesi">
          <option value="">Todos</option>
          <% Client.sources.keys.each do |src| %>
            <option value="<%= src %>"><%= src.humanize %></option>
          <% end %>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-negro-onix">Estado (State)</label>
        <select data-leads-chart-target="state" data-action="change->leads-chart#updateFilters" class="mt-1 block p-2 w-full rounded-md border-gray-300 shadow-sm focus:border-rojo-carmesi focus:ring-rojo-carmesi">
          <option value="">Todos</option>
          <% @states.each do |st| %>
            <option value="<%= st.id %>"><%= st.display_name_with_abbreviation %></option>
          <% end %>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-negro-onix">Día específico</label>
        <input type="date" data-leads-chart-target="day" data-action="change->leads-chart#updateFilters" class="mt-1 block p-2 w-full rounded-md border-gray-300 shadow-sm focus:border-rojo-carmesi focus:ring-rojo-carmesi" />
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 w-full">
      <div>
        <label class="block text-sm font-medium text-negro-onix">Mes</label>
        <input type="month" data-leads-chart-target="month" data-action="change->leads-chart#updateFilters" class="mt-1 block p-2 w-full rounded-md border-gray-300 shadow-sm focus:border-rojo-carmesi focus:ring-rojo-carmesi" />
      </div>
      <div data-leads-chart-target="dateFromWrapper" class="hidden">
        <label class="block text-sm font-medium text-negro-onix">Desde (dentro del mes)</label>
        <input type="date" data-leads-chart-target="dateFrom" data-action="change->leads-chart#updateFilters" class="mt-1 block p-2 w-full rounded-md border-gray-300 shadow-sm focus:border-rojo-carmesi focus:ring-rojo-carmesi" disabled />
      </div>
      <div data-leads-chart-target="dateToWrapper" class="hidden">
        <label class="block text-sm font-medium text-negro-onix">Hasta (dentro del mes)</label>
        <input type="date" data-leads-chart-target="dateTo" data-action="change->leads-chart#updateFilters" class="mt-1 block p-2 w-full rounded-md border-gray-300 shadow-sm focus:border-rojo-carmesi focus:ring-rojo-carmesi" disabled />
      </div>
    </div>
  </div>

  <!-- KPIs -->
  <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
    <div class="bg-gray-50 rounded-lg shadow border-t-4 border-red-500 p-4">
      <p class="text-xs font-medium text-gray-500">Base de datos</p>
      <p class="mt-1 text-2xl font-semibold text-gray-900" data-leads-chart-target="kpiBaseDeDatos">0</p>
    </div>
    <div class="bg-gray-50 rounded-lg shadow border-t-4 border-amber-500 p-4">
      <p class="text-xs font-medium text-gray-500">Meta</p>
      <p class="mt-1 text-2xl font-semibold text-gray-900" data-leads-chart-target="kpiMeta">0</p>
    </div>
    <div class="bg-gray-50 rounded-lg shadow border-t-4 border-emerald-500 p-4">
      <p class="text-xs font-medium text-gray-500">Referencia</p>
      <p class="mt-1 text-2xl font-semibold text-gray-900" data-leads-chart-target="kpiReferencia">0</p>
    </div>
    <div class="bg-gray-50 rounded-lg shadow border-t-4 border-blue-500 p-4">
      <p class="text-xs font-medium text-gray-500">Prospectación</p>
      <p class="mt-1 text-2xl font-semibold text-gray-900" data-leads-chart-target="kpiProspectacion">0</p>
    </div>
    <div class="bg-gray-50 rounded-lg shadow border-t-4 border-purple-600 p-4">
      <p class="text-xs font-medium text-gray-500">Otro</p>
      <p class="mt-1 text-2xl font-semibold text-gray-900" data-leads-chart-target="kpiOtro">0</p>
    </div>
    <div class="bg-gray-50 rounded-lg shadow border-t-4 border-indigo-500 p-4">
      <p class="text-xs font-medium text-gray-500">Total</p>
      <p class="mt-1 text-2xl font-semibold text-gray-900" data-leads-chart-target="kpiTotal">0</p>
    </div>
  </div>

  <div data-leads-chart-target="chart" class="w-full h-[320px]"></div>
</div>